\documentclass[a4paper]{article}
\usepackage{pmstyle}

\begin{document}
\hyphenation{СПбГУ}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                     УДК | АВТОР | НАЗВАНИЕ СТАТЬИ               %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% УДК для статьи берется со страницы http://teacode.com/online/udc/
\udk{УДК 510}

\author{Миронов~А.\:В., Юлдашев~Р.\:В.}

%%%%%%%%%   Название статьи
\title{Оценка области захвата для систем ФАПЧ 3 порядка}

\renewcommand{\thefootnote}{ }
{\footnotetext{{\it Миронов Алексей Владиславович} -- студент, Санкт-Петербургский государственный университет; e-mail: alexmir2015@yandex.ru, тел.: +7(911)146-14-40}}
{\footnotetext{{\it Юлдашев Ренат Владимирович} -- профессор, Санкт-Петербургский государственный университет; e-mail: email@email.ru, тел.: +7(000)000-00-00}}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%                РЕКОМЕНДАЦИЯ К ПУБЛИКАЦИИ                %%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%% Рекомендовано профессором ...
%\recprof{Юлдашевым~Р.\:В.}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\razdel{Введение}
Система фазовой автоподстройки частоты (ФАПЧ)~--- система с обратной связью, используемая для синхронизации сигналов эталонного и подстраиваемого генераторов. Она появилась в первой половине XX века \cite{appleton}. В настоящее время системы ФАПЧ применяются в различном телекоммуникационном оборудовании, навигационных системах и т.\,д. \cite{best}.

На практике часто используют системы ФАПЧ второго порядка. Наряду с системами ФАПЧ второго порядка исследуются системы третьего порядка, отличающиеся хорошим подавлением шума и более низкой стационарной ошибкой \cite{thirdOrderPLL}.

Хорошо известна система дифференциальных уравнений, описывающих ФАПЧ \cite{kuznetsov_article}
 \begin{equation}\label{pllequations}
 \begin{aligned}
 &\dot{x} = Ax + b\upsilon_e(\theta_e)\\
 &\dot{\theta}_e = \omega_e^{free} - K_{vco}(c^*x + h\upsilon_e(\theta_e))
 \end{aligned}
\end{equation}
Где $A$~--- постоянная матрица $n \times n$, $b$ и $c$ постоянные $n$~--- мерные векторы, $h$~--- константа, $x(t)$~--- $n$-мерный вектор состояний системы, $\omega^{free}_{vco}$~--- частота свободных колебаний ГУН, $K_{vco}$~--- коэфициент передачи. При этом предполагается, что эталонный генератор работает на постоянной частоте.

В системе \eqref{pllequations} сделаем преобразования $-K_{vco}c \rightarrow c$, $-K_{vco}h \rightarrow h$ и замену 
 \begin{equation}\label{replacement}
 \begin{aligned}
 z = x + A^{-1}b\gamma \text{,} \quad \gamma = \frac{\omega_e^{free}}{c^*A^{-1}b-h}
 \end{aligned}
\end{equation}
Тогда система \eqref{pllequations} принимает вид
 \begin{equation}\label{system}
 \begin{aligned}
 &\dot{z} = Az + b(\upsilon_e(\theta_e) - \gamma)\\
 &\dot{\theta_e} = c^*z + h(\upsilon_e(\theta_e) - \gamma))
 \end{aligned}
\end{equation}

Рассмотрим систему\eqref{system}, предполагая, что функция $\upsilon_e(\theta_e)$ дифференцируема на $\mathbb {R}$ и удовлетворяет условиям
 \begin{equation}
 \begin{aligned}
\mu_1 \leqslant \frac{d\upsilon_e(\theta_e)}{d\theta_e} \leqslant \mu_2
 \end{aligned}
\end{equation}
Введем в рассмотрение число:
 \begin{equation}
 \begin{aligned}
\nu = \int_{0}^{2\pi} \left(\upsilon_e(\theta_e) - \gamma\right) d\theta_e \left(\int_{0}^{2\pi} \mid \upsilon_e(\theta_e) - \gamma \mid d\theta_e\right)^{-1}
 \end{aligned}
\end{equation}

\TheoremCite{leonov}{
Пусть все нули функции $\upsilon_e(\theta_e) - \gamma$ изолированы, пара $(A, b)$ вполне управляема, все собственные значения матрицы $A$ имеют отрицательные вещественные части и существуют числа $\varepsilon > 0, \delta > 0, \tau \geqslant 0$, и $\varkappa$, такие что имеют место неравенства:
 \begin{align}
&\operatorname{Re}\left( \varkappa K(ix)- \varepsilon\left[K(ix)\right]^2-\left[ K(ix)+\mu_1^{-1}ix \right]^*\tau\left[K(ix)+\mu_2^{-1}ix \right]\right)  \geqslant \delta\text{,}\quad \forall x \in \mathbb{R}\label{first_th_eq}\\
&4\varepsilon\delta > (\varkappa\nu)^2
\end{align}
Тогда система \eqref{system} глобально ассимптотически устойчива.
}
\razdel{Инженерное применение}
Приведенная теорема не отвечает на вопрос как найти полосу захвата, т.\,е. максимальный интервал $\omega_e^{free} \in [0, \omega_{pull-in}]$, при котором система \eqref{pllequations} глобально ассимптотически устойчива. Этот вопрос является важным для инженеров при физической реализации ФАПЧ. Для ответа рассмотрим некоторые фильтры 2 порядка. Найдем $\varepsilon, \delta, \varkappa, \tau$, удовлетворяющие условию теоремы так, что бы максимизировать $\nu$. При характеристике фазового детектора $\upsilon(\theta_e) = sin(\theta_e)$, $\nu$ выражается следующим образом
 \begin{equation}\label{gamma}
 \begin{aligned}
\mid\nu\mid = \frac{0,5\pi\gamma}{\gamma \operatorname{arcsin} (\gamma) + \sqrt{1-\gamma^2}}
 \end{aligned}
\end{equation}
Из \eqref{gamma} и второго уравнения \eqref{replacement} можно однозначно найти $\omega_e^{free}$. Из максимальности $\nu$ получим максимальный $\omega_e^{free}$, при котором система \eqref{pllequations} глобально ассимтотически устойчива.
\razdel{Оценка области захвата для систем ФАПЧ с фильтром $\frac{1}{(1+\tau_{p1}s)(1+\tau_{p2}s)}$}
Рассмотрим передаточную функцию:
 \begin{equation}\label{filter1}
 \begin{aligned}
&W(s) = \frac{1}{(1+\tau_{p1}s)(1+\tau_{p2}s)} = \frac{1}{1+as + bs^2}\\
&a = \tau_{p1}+\tau_{p2} \text{,} \quad b = \tau_{p1}\tau_{p2} \text{,} \quad 0 < \tau_{p1} < 1 \text{,} \quad 0 < \tau_{p2} <1
 \end{aligned}
\end{equation}
Поскольку $\text{det}(sI-A) = s^2 + ab^{-1}s + b^{-1}$, матрица $A$~--- устойчива. Очевидно, что пара $\left(A, b\right)$ вполне управляема. Подставим \eqref{filter1} в \eqref{first_th_eq} и перенесем все в левую часть неравенства. Сделаем замену переменной $t = s^2$. Для максимизации $\nu$ положим $\varepsilon = \varkappa - \tau - \delta$. Не умаляя общности, можем считать $\varkappa = 1$, тогда первое условие теоремы принимает вид
\begin{equation}\label{ineq1} 
 \begin{aligned}
&At^2 + Bt + C \geqslant 0 \text{,}\quad \forall t \in \mathbb{R_+}\\
&A = \tau b^2 \text{,}\quad
B = \tau a^2-2 \tau b - \delta b^2 \text{,}\quad
C = - b+\tau-\delta a^2 + 2\delta b
 \end{aligned}
\end{equation}
Для того, что бы выполнялось \eqref{ineq1} необходимо потребовать $A \geqslant 0$ и $C \geqslant 0$, тогда $B \geqslant 0$. Будем искать максимум следующей функции 
\begin{equation}\label{extr_filter1}
 \begin{aligned}
\nu^2 < 4\delta-4\tau\delta - 4\delta^2
 \end{aligned}
\end{equation} 
\Figure{\textwidth}{images/agregated.jpg}{Точное и вычисленное решения для фильтра \eqref{filter1}}

Получили задачу на условный экстремум, т.\,е. найти максимум \eqref{extr_filter1}, при условии $C \geqslant 0$.  Заметим, что максимальное значение достигается на границе или в точках понижения ранга. Однако точки падения ранга противоречат условию теоремы. Рассмотри границу допустимой области, т.\,е. $C = 0$, выразим $\tau$ через $\delta$ и подставим в \eqref{extr_filter1}
\begin{equation}\label{one_var_max}
 \begin{aligned}
\nu^2 < 4\delta(1 - b) - 4\delta^2(a^2 -2b +1)
 \end{aligned}
\end{equation} 
Максимум  \eqref{one_var_max} достигается при $\delta = \frac{1-b}{2(a^2 - 2b + 1)}$ и равен
\begin{equation}\label{filter1_max}
 \begin{aligned}
\nu^2 < \frac{(b - 1)^2}{a^2 - 2b + 1} = \frac{(\tau_{p1}\tau_{p2} - 1)^2}{\tau_{p1}^2 + \tau_{p2}^2 + 1}
 \end{aligned}
\end{equation} 

\razdel{Оценка области захвата для систем ФАПЧ с фильтром $\frac{1+\alpha_1\beta_1s + \alpha_2\beta_2s^2}{1+\alpha_1s + \alpha_2s^2}$}
 Рассмотрим передаточную функцию
 \begin{equation}\label{filter3}
 \begin{aligned}
W(x) = \frac{1+\alpha_1\beta_1s + \alpha_2\beta_2s^2}{1+\alpha_1s + \alpha_2s^2}
 \end{aligned}
\end{equation}
Где $\alpha_1$, $\alpha_2$, $\beta_1$, $\beta_2$ вещественные положительные числа. Предположим
 \begin{equation}\label{restriction-1}
 \begin{aligned}
\beta_1 < \beta_2 < 1
 \end{aligned}
\end{equation}
Поскольку $\text{det}(sI-A) = s^2 + \alpha_1\alpha_2^{-1}s + \alpha_2^{-1}$, матрица $A$~--- устойчива. Очевидно, что пара $\left(A, b\right)$ вполне управляема. Подставим \eqref{filter3} в \eqref{first_th_eq} и перенесем все в левую часть неравенства. Положим $\tau = 0$, и не умаляя общности можем считать $\varkappa = 1$.  Для максимизации $\nu$ положим $\varepsilon = 1-\delta$. Тогда \eqref{first_th_eq} принимает вид
 \begin{equation}\label{filter3-3}
 \begin{aligned}
 &(\alpha_2^2\beta_2 - \alpha_2^2\delta - \alpha_2^2\beta_2^2 + \alpha_2^2\beta_2^2\delta)t+\alpha_2\beta_2 - \alpha_2 + 2\alpha_2\delta + \alpha_1^2\beta_1 - \\
 &- \alpha_1^2\delta - \alpha_1^2\beta_1^2 + \alpha_1^2\beta_1^2\delta - 2\alpha_2\beta_2\delta \geqslant 0 \text{,}\quad \forall t \in \mathbb{R_+}
 \end{aligned}
\end{equation}
Выполнение \eqref{restriction-1} влечет положительность старшего коэффициента. Так как максимальное значение достигается в точках падения ранга или на границе положим, что свободный член раыен нулю. Получаем
 \begin{equation}\label{filter3_positive_numerator}
 \begin{aligned}
\delta = \frac{\alpha_1^2(1-\beta_1)\beta_1 - \alpha_2(1-\beta_2)}{\alpha_1^2(1-\beta_1^2) - 2\alpha_2(1-\beta_2)}
 \end{aligned}
 \end{equation}
Для того что бы $\delta > 0$ потребуем $\alpha_1^2 > \frac{\alpha_2(1-\beta_2)}{\beta_1(1-\beta_1)}$. Это условие гарантирует положительность числителя и знаменателя \eqref{filter3_positive_numerator}.
В результате преобразований получили оценку для $\nu^2$
 \begin{equation}
 \begin{aligned}
\nu^2 < 4\frac{[\alpha_1^2(1-\beta_1) - \alpha_2(1-\beta_2)][\alpha_1^2(1-\beta_1)\beta_1 - \alpha_2(1-\beta_2)]}{[\alpha_1^2(1-\beta_1^2) - 2\alpha_2(1-\beta_2)]^2}
 \end{aligned}
 \end{equation}
Эта оценка была получена в \cite{kuznetsov}, однако вывод был пропущен.
\razdel{Заключение}
В настояцее время системы фазовой автоподстройки частоты и их модификации применяются во многих системах, где требуется синхронизация частот. Полученный резкльтат будет интересен инженерам и может использоваться при проектировании и реализации систем ФАПЧ третьего порядка.

\begin{thebibliography}{40}
\bibitem{best}  Best~R.\:E. Phase-Locked Loops: Design, Simulation, and Applications / McGraw-Hill Education, 2007. P.~195--207.
\bibitem{kuznetsov}  Leonov~G.\:A., Kuznetsov~N.\:V. Nonlinear mathematical models of phase-locked loops : stability and oscillations / Cambridge Scientific Publishers, 2014. P.~112--113.
\bibitem{leonov}  Леонов~Г.\:А., Селеджи~С.\:М. Системы фазовой синхронизации в аналоговой и цифровой схемотехнике / СПб.:~Изд-во Невский диалект, 2014. P.~195--207.
\bibitem{kuznetsov_article} Kuznetsov~N.\:V., Leonov~G.\:A., Yuldashev~M.\:V., Yuldashev~R.\:V. Solution of the Gardner problem on the lock-in range of phase-locked loop // ArXiv e-prints. 2017. 1705.05013. P.~289--298.
\bibitem{appleton} Appleton~E.\:E. Automatic synchronization of triode oscillators // Proc. Camb. Phil. Soc. 1923. Vol.~21, No~3. P.~231.
\bibitem{thirdOrderPLL} Feng~L., Wu~C., Jin~B., Wu~Z. A Passive Third-order Cascade PLL Filter // Trans Tech Publications. 2011. Vols. 255-260. P.~1.
\end{thebibliography}
\end{document}
